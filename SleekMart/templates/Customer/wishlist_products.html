{% load static %}
{% block content %}

<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&display=swap" rel="stylesheet">

    <title>SleekMart - Product Detail Page</title>


    <!-- Additional CSS Files -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">

    <link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.css' %}">

    <link rel="stylesheet" href="{% static 'css/templatemo-hexashop.css' %}">

    <link rel="stylesheet" href="{% static 'css/owl-carousel.css' %}">

    <link rel="stylesheet" href="{% static 'css/lightbox.css' %}">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'js/popper.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <style>
        .page-heading {
            margin-top: 80px;
            margin-bottom: 30px;
            background-image: url('{{ product.subcategory.image.url }}');
            background-position: center center;
            background-size: cover;
            background-repeat: no-repeat;
            
           
        }
        .header-area.header-sticky {
            min-height: 80px;
            background-color: #34a3b4;
          }
          #product .right-content ul.stars {
            position: relative;
            right: -210px;
            top: -45px;
          }
        /* Define styles for the products heading container */
        .products-heading {
            background-color: #34a3b4;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
        }
        
        /* Define styles for the section title */
        .section-title {
            color: #333;
            font-size: 30px;
            margin: 0;
            text-transform: uppercase;
            background-color: #fff;
            border: 2px solid #007bff;
            padding: 10px 20px;
            border-radius: 4px;
            display: inline-block;
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.2);
            animation: floatAnimation 3s ease-in-out infinite, colorChange 4s alternate infinite; /* Apply both animations */
        }
        
        /* Keyframes for the floating animation */
        @keyframes floatAnimation {
            0% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px); /* Adjust the vertical float distance */
            }
            100% {
                transform: translateY(0);
            }
        }
        
        /* Keyframes for changing text color */
        @keyframes colorChange {
            0% {
                color: #007bff; /* Initial color */
            }
            100% {
                color: #ff0000; /* New color (you can adjust this) */
            }
        }
        
    
    </style>
</head>

<body>


<header class="header-area header-sticky">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="main-nav">
                    <!-- ***** Logo Start ***** -->
                    <a href="{% url 'dashboard_home' %}" class="logo">
                        <h5 style="color:black;position:absolute;top:35px;">Sleek Mart </h5>
                    </a>
                    <!-- ***** Logo End ***** -->
                    <!-- ***** Menu Start ***** -->
                    <ul class="nav">
                        <li class="scroll-to-section"><a href="{% url 'dashboard_home' %}" class="active">Home</a></li>
                        {% for category in categories %}
                        <li class="scroll-to-section"><a href="{% url 'products' category.id %}">{{ category.name }}</a></li>
                        {% comment %} <li class="scroll-to-section"><a href="{% url 'dashboard_home' %}">Women's</a></li>
                        <li class="scroll-to-section"><a href="{% url 'dashboard_home' %}">Kid's</a></li> {% endcomment %}
                        {% endfor %}
                        {% comment %} <li class="submenu">
                            <a href="javascript:;">Pages</a>
                            <ul>
                                <li><a href="about">About Us</a></li>
                                <li><a href="products">Products</a></li>
                                <li><a href="single-product">Single Product</a></li>
                                <li><a href="contact">Contact Us</a></li>
                            </ul>
                        </li>
                        <li class="submenu">
                            <a href="javascript:;">Features</a>
                            <ul>
                                <li><a href="#">Features Page 1</a></li>
                                <li><a href="#">Features Page 2</a></li>
                                <li><a href="#">Features Page 3</a></li>
                                <li><a rel="nofollow" href="https://templatemo.com/page/4" target="_blank">Template Page 4</a></li>
                            </ul>
                        </li> {% endcomment %}
                        <li class="scroll-to-section">
                          <a href="{% url 'cart_details' %}">Cart <span class="cart-count" style="color:red;">({{ cart_count }})</span></a>
                      </li>
                        <li class="scroll-to-section">
                            <a href="{% url 'view_wishlist' %}"> Wishlist <span class="wishlist-count" style="color:red;">({{ wishlist_count }})</span></a>
                        </li>
                        {% if user.is_authenticated %}
                        <li class="scroll-to-section"><a href="{% url 'loggout' %}">Logout</a></li>
                        {% else %}
                        <li class="scroll-to-section"><a href="{% url 'loggout' %}">SignIn/Signup</a></li>
                        {% endif %}
                    </ul>        
                    <a class='menu-trigger'>
                        <span>Menu</span>
                    </a>
                    <!-- ***** Menu End ***** -->
                </nav>
            </div>
        </div>
    </div>
</header>
  <div class="container mt-5">
    <h2 class="mb-4">Your Wishlist</h2>

    {% if wishlist_products %}
      <div class="row">
        {% for product in wishlist_products %}
          <div class="col-md-4 mb-4">
            <div class="card">
              <img src="{{ product.products.product_image.url }}" class="card-img-top" alt="{{ product.products.name }}" style="height: 200px; width:190px;">
              <div class="card-body">
                <h5 class="card-title">{{ product.products.name }}</h5>
                <p class="card-text">${{ product.products.selling_price }}</p>
                <a href="{% url 'each_product' product.products.id %}" class="btn btn-primary btn-sm">View Product</a>
                <a href="{% url 'view_wishlist'%}" class="btn btn-danger btn-sm remove-from-wishlist" data-product-id="{{ product.products.id }}">Remove from Wishlist</a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="alert alert-info">
        Your wishlist is empty. <a href="{% url 'dashboard_home' %}" class="alert-link">Start shopping now</a>!
      </div>
    {% endif %}
  </div>

  <script>
    // Function to remove a product from the wishlist
    function removeFromWishlist(productId) {
      $.ajax({
        type: 'POST',
        url: `/remove_from_wishlist/${productId}/`,  // Replace with the correct URL
        data: {
          csrfmiddlewaretoken: '{{ csrf_token }}'  // Include the CSRF token for security
        },
        success: function (data) {
          // Product removed successfully, you can update the UI or display a message
          console.log(data.message);
          
          // Remove the product's card from the UI
          $(`[data-product-id=${productId}]`).closest('.card').remove();
        },
        error: function (xhr, status, error) {
          // Handle errors, e.g., product not found or user not authenticated
          console.error(xhr.responseText);
        }
      });
    }
  
    // Attach a click event handler to the "Remove from Wishlist" buttons
    $('.remove-from-wishlist').click(function () {
      const productId = $(this).data('product-id');
      removeFromWishlist(productId);
    });
  </script>
  
{% endblock %}
</body>
</html>